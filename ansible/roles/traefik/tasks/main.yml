---
- name: Ensure traefik folder exists
  ansible.builtin.file:
      path: "/etc/containers/systemd/traefik"
      state: directory
      mode: "0755"

- name: Ensure traefik service files are in place
  ansible.builtin.copy:
      src: "{{ item }}"
      dest: "/etc/containers/systemd/traefik/{{ item }}"
      backup: true
      mode: "0644"
  loop:
      - traefik.network
      - traefik.pod
      - traefik.container
      - traefik-certs.volume
      - traefik-certs-dumper.container
      - traefik-certs-dumper.volume
      - traefik.yaml
  notify: Restart Traefik service
